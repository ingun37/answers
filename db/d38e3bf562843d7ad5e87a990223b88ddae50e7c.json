{
    "item": {
        "attr": {
            "q": "<p>There are two coins in a bag. For Coin 1, <span\nclass=\"math inline\">P(H)=\\frac{1}{2}</span> and for Coin 2, <span\nclass=\"math inline\">P(H)=\\frac{1}{3}</span>. Your friend chooses one of\nthe coins at random and tosses it 5 times.</p>"
        },
        "numAnswer": 2,
        "sha1": "d38e3bf562843d7ad5e87a990223b88ddae50e7c",
        "title": "13"
    },
    "kids": [
        {
            "attr": {
                "a": "<p>Let <span class=\"math inline\">A</span> be the event of choosing the\nfirst coin, <span class=\"math inline\">B</span> the second coin, <span\nclass=\"math inline\">H_i</span> the observing <span\nclass=\"math inline\">i</span> heads. They are partitions therefore</p>\n<p><span class=\"math display\">P(H_3 \\cup H_4 \\cup H_5) = P(H_3 \\cup H_4\n\\cup H_5|A)P(A) + P(H_3 \\cup H_4 \\cup H_5|B)P(B)</span></p>\n<p>Since <span class=\"math inline\">H_i</span> are all disjoint\nevents</p>\n<p><span class=\"math display\">= (P(H_3|A) + P(H_4|A) + P(H_5|A))P(A) +\n(P(H_3|B) + P(H_4|B) + P(H_5|B))P(B)</span></p>\n<p><span class=\"math inline\">P(H_3|A)</span> is having three heads and\ntwo tails using the first coin.</p>\n<p><span class=\"math display\">P(H_3|A) = {5 \\choose 3} \\left({1 \\over\n2}\\right)^3 \\left({1 \\over 2}\\right)^2 = {5 \\choose 3}{1 \\over\n2^5}</span></p>\n<p>We can calculate each terms in the same way.</p>\n<p><span class=\"math display\">= ({5 \\choose 3}{1 \\over 2^5}\n+ {5 \\choose 4}{1 \\over 2^5}  \n+ {5 \\choose 5}{1 \\over 2^5}  )P(A) +\n({5 \\choose 3}{2^2 \\over 3^5 }\n+ {5 \\choose 4}{ 2 \\over 3^5}\n+ {5 \\choose 5}{1 \\over 3^5}\n)P(B)</span></p>\n<p>Since <span class=\"math inline\">P(A) = P(B) = {1 \\over 2}</span></p>\n<p>\\[= (10 + 5 + 1){1 \\over 2^6} + (40 + 10 + 1 ){1 \\over 3^5 2} \\</p>\n<p>\\approx 0.3549\\]</p>\n<p>Here's a validating program.</p>\n<div class=\"sourceCode\" id=\"cb1\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">Lib</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ( someFunc</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ) <span class=\"kw\">where</span></span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">System.Random</span></span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">System.Random.Shuffle</span></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Ix</span></span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Ratio</span></span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Set</span> <span class=\"kw\">hiding</span> (map, take, filter)</span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.List.Split</span></span>\n<span id=\"cb1-10\"><a href=\"#cb1-10\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-11\"><a href=\"#cb1-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">someFunc ::</span> <span class=\"dt\">IO</span> ()</span>\n<span id=\"cb1-12\"><a href=\"#cb1-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>someFunc <span class=\"ot\">=</span> <span class=\"kw\">do</span></span>\n<span id=\"cb1-13\"><a href=\"#cb1-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>    problem13</span>\n<span id=\"cb1-14\"><a href=\"#cb1-14\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-15\"><a href=\"#cb1-15\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">problem13 ::</span> <span class=\"dt\">IO</span> ()</span>\n<span id=\"cb1-16\"><a href=\"#cb1-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>problem13 <span class=\"ot\">=</span> <span class=\"kw\">do</span></span>\n<span id=\"cb1-17\"><a href=\"#cb1-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> seeds <span class=\"ot\">=</span> [<span class=\"dv\">1</span><span class=\"op\">..</span>]</span>\n<span id=\"cb1-18\"><a href=\"#cb1-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> sampleSize <span class=\"ot\">=</span> <span class=\"dv\">1000000</span></span>\n<span id=\"cb1-19\"><a href=\"#cb1-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> samples <span class=\"ot\">=</span> <span class=\"fu\">take</span> sampleSize <span class=\"op\">$</span> <span class=\"fu\">map</span> pickAndFlip5 seeds</span>\n<span id=\"cb1-20\"><a href=\"#cb1-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> events <span class=\"ot\">=</span> <span class=\"fu\">filter</span> ((<span class=\"dv\">2</span><span class=\"op\">&lt;</span>) <span class=\"op\">.</span> <span class=\"fu\">length</span> <span class=\"op\">.</span> <span class=\"fu\">filter</span> <span class=\"fu\">id</span>) samples</span>\n<span id=\"cb1-21\"><a href=\"#cb1-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> eventSize <span class=\"ot\">=</span> <span class=\"fu\">length</span> events</span>\n<span id=\"cb1-22\"><a href=\"#cb1-22\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> approxRatio eventSize sampleSize</span>\n<span id=\"cb1-23\"><a href=\"#cb1-23\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-24\"><a href=\"#cb1-24\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">flipCoinN ::</span> <span class=\"dt\">RandomGen</span> g <span class=\"ot\">=&gt;</span> <span class=\"dt\">Double</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> g <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Bool</span>]</span>\n<span id=\"cb1-25\"><a href=\"#cb1-25\" aria-hidden=\"true\" tabindex=\"-1\"></a>flipCoinN p n <span class=\"ot\">=</span> <span class=\"fu\">map</span> (p<span class=\"op\">&gt;</span>) <span class=\"op\">.</span> <span class=\"fu\">take</span> n <span class=\"op\">.</span> randomRs (<span class=\"fl\">0.0</span>, <span class=\"fl\">1.0</span>)</span>\n<span id=\"cb1-26\"><a href=\"#cb1-26\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-27\"><a href=\"#cb1-27\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">pickAndFlip5 ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Bool</span>]</span>\n<span id=\"cb1-28\"><a href=\"#cb1-28\" aria-hidden=\"true\" tabindex=\"-1\"></a>pickAndFlip5 seed <span class=\"ot\">=</span> <span class=\"kw\">let</span> (which, g) <span class=\"ot\">=</span> (random <span class=\"op\">$</span> mkStdGen seed)</span>\n<span id=\"cb1-29\"><a href=\"#cb1-29\" aria-hidden=\"true\" tabindex=\"-1\"></a>                   <span class=\"kw\">in</span> <span class=\"kw\">if</span> which</span>\n<span id=\"cb1-30\"><a href=\"#cb1-30\" aria-hidden=\"true\" tabindex=\"-1\"></a>                       <span class=\"kw\">then</span> flipCoinN <span class=\"fl\">0.5</span> <span class=\"dv\">5</span> g</span>\n<span id=\"cb1-31\"><a href=\"#cb1-31\" aria-hidden=\"true\" tabindex=\"-1\"></a>                       <span class=\"kw\">else</span> flipCoinN <span class=\"fl\">0.3333333333</span> <span class=\"dv\">5</span> g</span>\n<span id=\"cb1-32\"><a href=\"#cb1-32\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-33\"><a href=\"#cb1-33\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">approxRatio ::</span> <span class=\"dt\">Integral</span> i <span class=\"ot\">=&gt;</span> i <span class=\"ot\">-&gt;</span> i <span class=\"ot\">-&gt;</span> <span class=\"dt\">Double</span></span>\n<span id=\"cb1-34\"><a href=\"#cb1-34\" aria-hidden=\"true\" tabindex=\"-1\"></a>approxRatio x y <span class=\"ot\">=</span> <span class=\"fu\">fromRational</span> <span class=\"op\">$</span> (<span class=\"fu\">toInteger</span> x) <span class=\"op\">%</span> (<span class=\"fu\">toInteger</span> y)</span></code></pre></div>\n<p>Output is</p>\n<pre class=\"shell\"><code>0.356264</code></pre>\n<p>which is close enough to support the result.</p>",
                "q": "<p>What is the probability of observing at least 3 heads?</p>"
            },
            "numAnswer": 1,
            "sha1": "a8d843e73eda5af32d9281ea1f3f58f4d76315ac",
            "title": "a"
        },
        {
            "attr": {
                "a": "<p>Let <span class=\"math inline\">X</span> be the random variable of\nnumber of heads, <span class=\"math inline\">B</span> the event of\nchoosing the second coin. We are asked for this</p>\n<p><span class=\"math display\">P(B|X&gt;2)</span></p>\n<p>Using Bayes' rule</p>\n<p><span class=\"math display\">=\n\\cfrac{P(X&gt;2|B)P(B)}{P(X&gt;2)}</span></p>\n<p>We've already got the denominator <span\nclass=\"math inline\">P(X&gt;2)</span> from (a). We've also got the <span\nclass=\"math inline\">P(X&gt;2|B)</span> from the process of (a). Combine\nthem all.</p>\n<p><span class=\"math display\">\\approx \\cfrac{0.2098 * 0.5}{0.3549} \\\\\n\\approx 0.2955762</span></p>",
                "q": "<p>You ask your friend: \"Did you observe at least three heads?\". Your\nfriend replies, \"Yes.\" What is the probability that Coin 2 had been\nchosen?</p>"
            },
            "numAnswer": 1,
            "sha1": "bc09b985728fb882ccc5bc3ca57b9784b1d2ea9f",
            "title": "b"
        }
    ],
    "parentSha1": "02eb340c5eb912c392c7f474bad54dc827bbfd87",
    "path": "answers-db/books/Introduction to Probability, Statistics, and Random Processes/2.2.0/13"
}