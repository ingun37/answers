{
    "item": {
        "attr": {
            "a": {
                "content": "<div class=\"sourceCode\" id=\"cb1\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">Lib</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ( alg, <span class=\"dt\">RingF</span>(<span class=\"op\">..</span>), calc</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ) <span class=\"kw\">where</span></span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">data</span> <span class=\"dt\">RingF</span> a <span class=\"ot\">=</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RAdd</span> a a </span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RMul</span> a a</span>\n<span id=\"cb1-10\"><a href=\"#cb1-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RNeg</span> a</span>\n<span id=\"cb1-11\"><a href=\"#cb1-11\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-12\"><a href=\"#cb1-12\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">instance</span> <span class=\"dt\">Functor</span> <span class=\"dt\">RingF</span> <span class=\"kw\">where</span></span>\n<span id=\"cb1-13\"><a href=\"#cb1-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">fmap</span> f r <span class=\"ot\">=</span> <span class=\"kw\">case</span> r <span class=\"kw\">of</span></span>\n<span id=\"cb1-14\"><a href=\"#cb1-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RZero</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-15\"><a href=\"#cb1-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">ROne</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-16\"><a href=\"#cb1-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RAdd</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RAdd</span> (f a) (f b)</span>\n<span id=\"cb1-17\"><a href=\"#cb1-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RMul</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RMul</span> (f a) (f b)</span>\n<span id=\"cb1-18\"><a href=\"#cb1-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RNeg</span> a <span class=\"ot\">-&gt;</span> <span class=\"dt\">RNeg</span> (f a)</span>\n<span id=\"cb1-19\"><a href=\"#cb1-19\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-20\"><a href=\"#cb1-20\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">type</span> <span class=\"dt\">Ring</span> <span class=\"ot\">=</span> <span class=\"dt\">Fix</span> <span class=\"dt\">RingF</span></span>\n<span id=\"cb1-21\"><a href=\"#cb1-21\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-22\"><a href=\"#cb1-22\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">take&#39; ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-23\"><a href=\"#cb1-23\" aria-hidden=\"true\" tabindex=\"-1\"></a>take&#39; n l <span class=\"ot\">=</span> <span class=\"kw\">if</span> n <span class=\"op\">&gt;</span> <span class=\"dv\">0</span> <span class=\"kw\">then</span> <span class=\"kw\">case</span> l <span class=\"kw\">of</span> [] <span class=\"ot\">-&gt;</span> <span class=\"fu\">replicate</span> n <span class=\"dv\">0</span></span>\n<span id=\"cb1-24\"><a href=\"#cb1-24\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                    (x<span class=\"op\">:</span>xs) <span class=\"ot\">-&gt;</span> x<span class=\"op\">:</span>(take&#39; (n<span class=\"op\">-</span><span class=\"dv\">1</span>) xs)</span>\n<span id=\"cb1-25\"><a href=\"#cb1-25\" aria-hidden=\"true\" tabindex=\"-1\"></a>                     <span class=\"kw\">else</span> []</span>\n<span id=\"cb1-26\"><a href=\"#cb1-26\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">degree ::</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span></span>\n<span id=\"cb1-27\"><a href=\"#cb1-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>degree xs <span class=\"ot\">=</span> <span class=\"fu\">max</span> <span class=\"dv\">0</span> <span class=\"op\">$</span> <span class=\"fu\">length</span> xs <span class=\"op\">-</span> <span class=\"dv\">1</span></span>\n<span id=\"cb1-28\"><a href=\"#cb1-28\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-29\"><a href=\"#cb1-29\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">alg ::</span> <span class=\"dt\">RingF</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-30\"><a href=\"#cb1-30\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg <span class=\"dt\">RZero</span> <span class=\"ot\">=</span> []</span>\n<span id=\"cb1-31\"><a href=\"#cb1-31\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg <span class=\"dt\">ROne</span> <span class=\"ot\">=</span> [<span class=\"dv\">1</span>]</span>\n<span id=\"cb1-32\"><a href=\"#cb1-32\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RNeg</span> x) <span class=\"ot\">=</span> <span class=\"fu\">map</span> <span class=\"fu\">negate</span> x</span>\n<span id=\"cb1-33\"><a href=\"#cb1-33\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RAdd</span> (x<span class=\"op\">:</span>xs) (y<span class=\"op\">:</span>ys)) <span class=\"ot\">=</span> (x<span class=\"op\">+</span>y)<span class=\"op\">:</span>(alg <span class=\"op\">$</span> <span class=\"dt\">RAdd</span> xs ys)</span>\n<span id=\"cb1-34\"><a href=\"#cb1-34\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RAdd</span> [] y) <span class=\"ot\">=</span> y</span>\n<span id=\"cb1-35\"><a href=\"#cb1-35\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RAdd</span> x []) <span class=\"ot\">=</span> x</span>\n<span id=\"cb1-36\"><a href=\"#cb1-36\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RMul</span> x y) <span class=\"ot\">=</span> <span class=\"kw\">let</span><span class=\"ot\"> f ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span></span>\n<span id=\"cb1-37\"><a href=\"#cb1-37\" aria-hidden=\"true\" tabindex=\"-1\"></a>                     f n <span class=\"ot\">=</span> <span class=\"kw\">let</span> xs <span class=\"ot\">=</span> take&#39; (n<span class=\"op\">+</span><span class=\"dv\">1</span>) x</span>\n<span id=\"cb1-38\"><a href=\"#cb1-38\" aria-hidden=\"true\" tabindex=\"-1\"></a>                               ys <span class=\"ot\">=</span> <span class=\"fu\">reverse</span> <span class=\"op\">$</span> take&#39; (n<span class=\"op\">+</span><span class=\"dv\">1</span>) y <span class=\"kw\">in</span></span>\n<span id=\"cb1-39\"><a href=\"#cb1-39\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                   <span class=\"fu\">sum</span> <span class=\"op\">$</span> <span class=\"fu\">zipWith</span> (<span class=\"op\">*</span>) xs ys</span>\n<span id=\"cb1-40\"><a href=\"#cb1-40\" aria-hidden=\"true\" tabindex=\"-1\"></a>                     <span class=\"kw\">in</span></span>\n<span id=\"cb1-41\"><a href=\"#cb1-41\" aria-hidden=\"true\" tabindex=\"-1\"></a>                         <span class=\"fu\">map</span> f [<span class=\"dv\">0</span><span class=\"op\">..</span>(degree x <span class=\"op\">+</span> degree y)]</span></code></pre></div>\n<h2 id=\"test\">Test</h2>\n<div class=\"sourceCode\" id=\"cb2\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Lib</span></span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb2-3\"><a href=\"#cb2-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb2-4\"><a href=\"#cb2-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">main ::</span> <span class=\"dt\">IO</span> ()</span>\n<span id=\"cb2-5\"><a href=\"#cb2-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>main <span class=\"ot\">=</span> <span class=\"kw\">do</span></span>\n<span id=\"cb2-6\"><a href=\"#cb2-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> cata alg <span class=\"op\">$</span> <span class=\"dt\">Fix</span> (<span class=\"dt\">RAdd</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>) (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>))</span></code></pre></div>\n<h2 id=\"result\">Result</h2>\n<pre class=\"shell\"><code>ingun$ stack test\n...\n[2]</code></pre>",
                "posixTime": 1580305043
            },
            "q": {
                "content": "<p>Implement the evaluation function for a ring of polynomials of one\nvariable. You can represent a polynomial as a list of coefficients in\nfront of powers of <code>x</code>. For instance, <span\nclass=\"math inline\">4x^2-1</span> would be represented as (starting with\nthe zero'th power) <code>[-1, 0, 4]</code>.</p>",
                "posixTime": 1580305043
            }
        },
        "numAnswer": 1,
        "sha1": "b12b2bea8989448243e1ab04369f436e4816bd81",
        "title": "1"
    },
    "kids": [],
    "parentSha1": "147af4f213c95f39c0f6f25b2995d70b68c39f10",
    "path": "answers-db/books/Category Theory For Programmers/24. F-Algebras/1"
}