{
    "item": {
        "attr": {
            "q": "<p>Sample project available here <a\nhref=\"https://github.com/ingun37/f-algebra-challenges\">github</a></p>"
        },
        "numAnswer": 5,
        "sha1": "147af4f213c95f39c0f6f25b2995d70b68c39f10",
        "title": "24. F-Algebras"
    },
    "kids": [
        {
            "attr": {
                "a": "<div class=\"sourceCode\" id=\"cb1\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">Un</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ( primes</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ) <span class=\"kw\">where</span></span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.List</span></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">primes ::</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>primes <span class=\"ot\">=</span> unfoldr (\\(prime<span class=\"op\">:</span>remains) <span class=\"ot\">-&gt;</span> <span class=\"dt\">Just</span> (prime, <span class=\"fu\">filter</span> (notdiv prime) remains)) [<span class=\"dv\">2</span><span class=\"op\">..</span>]</span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">where</span> notdiv p n <span class=\"ot\">=</span> n <span class=\"ot\">`mod`</span> p <span class=\"op\">/=</span> <span class=\"dv\">0</span></span></code></pre></div>",
                "q": "<p>Use <code>unfoldr</code> to generate a list of the first n\nprimes.</p>"
            },
            "numAnswer": 1,
            "sha1": "92fe566202c1f481f92f5da601c1051671809d13",
            "title": "5"
        },
        {
            "attr": {
                "a": "<p>Just like the book represented univariate polynomial with 1d array, I\nrepresented multivariate polynomial with multi-dimension array. But the\ndata structure for multi-dimension array is just a function. The\nfunction accepts index value of <code>[Int]</code>. You can think of\neach element represents degree of <code>x, y, z ...</code>s. For\nexample, <code>[0,1,2]</code> will mean <span\nclass=\"math inline\">x^0y^1z^2</span> (simply <span\nclass=\"math inline\">yz^2</span>) and the function will return it's\ncoefficient.</p>\n<p>Interesting thing is I used another F-Algebra <code>Pair</code>. It's\njust like the <code>StreamF</code> from the book which is used to\ndemonstrate a conversion to List.</p>\n<div class=\"sourceCode\" id=\"cb1\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">NPoly</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ( bb, alg, <span class=\"dt\">NPoly</span>, mulPoly</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ) <span class=\"kw\">where</span></span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Bifunctor</span></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">data</span> <span class=\"dt\">RingF</span> a <span class=\"ot\">=</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RAdd</span> a a </span>\n<span id=\"cb1-10\"><a href=\"#cb1-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RMul</span> a a</span>\n<span id=\"cb1-11\"><a href=\"#cb1-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RNeg</span> a</span>\n<span id=\"cb1-12\"><a href=\"#cb1-12\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-13\"><a href=\"#cb1-13\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">instance</span> <span class=\"dt\">Functor</span> <span class=\"dt\">RingF</span> <span class=\"kw\">where</span></span>\n<span id=\"cb1-14\"><a href=\"#cb1-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">fmap</span> f r <span class=\"ot\">=</span> <span class=\"kw\">case</span> r <span class=\"kw\">of</span></span>\n<span id=\"cb1-15\"><a href=\"#cb1-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RZero</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-16\"><a href=\"#cb1-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">ROne</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-17\"><a href=\"#cb1-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RAdd</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RAdd</span> (f a) (f b)</span>\n<span id=\"cb1-18\"><a href=\"#cb1-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RMul</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RMul</span> (f a) (f b)</span>\n<span id=\"cb1-19\"><a href=\"#cb1-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RNeg</span> a <span class=\"ot\">-&gt;</span> <span class=\"dt\">RNeg</span> (f a)</span>\n<span id=\"cb1-20\"><a href=\"#cb1-20\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-21\"><a href=\"#cb1-21\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">type</span> <span class=\"dt\">NPoly</span> <span class=\"ot\">=</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span></span>\n<span id=\"cb1-22\"><a href=\"#cb1-22\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-23\"><a href=\"#cb1-23\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">alg ::</span> <span class=\"dt\">RingF</span> <span class=\"dt\">NPoly</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">NPoly</span></span>\n<span id=\"cb1-24\"><a href=\"#cb1-24\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg <span class=\"dt\">RZero</span> <span class=\"ot\">=</span> <span class=\"fu\">const</span> <span class=\"dv\">0</span></span>\n<span id=\"cb1-25\"><a href=\"#cb1-25\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg <span class=\"dt\">ROne</span> <span class=\"ot\">=</span> \\x <span class=\"ot\">-&gt;</span> <span class=\"kw\">if</span> <span class=\"fu\">all</span> (<span class=\"dv\">0</span><span class=\"op\">==</span>) x <span class=\"kw\">then</span> <span class=\"dv\">1</span> <span class=\"kw\">else</span> <span class=\"dv\">0</span></span>\n<span id=\"cb1-26\"><a href=\"#cb1-26\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RAdd</span> f g) <span class=\"ot\">=</span> \\x <span class=\"ot\">-&gt;</span> (f x) <span class=\"op\">+</span> (g x)</span>\n<span id=\"cb1-27\"><a href=\"#cb1-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RMul</span> f1 f2) <span class=\"ot\">=</span> mulPoly f1 f2</span>\n<span id=\"cb1-28\"><a href=\"#cb1-28\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RNeg</span> f) <span class=\"ot\">=</span> <span class=\"fu\">negate</span> <span class=\"op\">.</span> f</span>\n<span id=\"cb1-29\"><a href=\"#cb1-29\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-30\"><a href=\"#cb1-30\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">mulPoly ::</span> <span class=\"dt\">NPoly</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">NPoly</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">NPoly</span></span>\n<span id=\"cb1-31\"><a href=\"#cb1-31\" aria-hidden=\"true\" tabindex=\"-1\"></a>mulPoly f1 f2 <span class=\"ot\">=</span> f</span>\n<span id=\"cb1-32\"><a href=\"#cb1-32\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">where</span> f x <span class=\"ot\">=</span> <span class=\"fu\">sum</span> <span class=\"op\">$</span> <span class=\"fu\">zipWith</span> (<span class=\"op\">*</span>) coef1 coef2</span>\n<span id=\"cb1-33\"><a href=\"#cb1-33\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"kw\">where</span> comb <span class=\"ot\">=</span> bb x</span>\n<span id=\"cb1-34\"><a href=\"#cb1-34\" aria-hidden=\"true\" tabindex=\"-1\"></a>                  for1 <span class=\"ot\">=</span> comb</span>\n<span id=\"cb1-35\"><a href=\"#cb1-35\" aria-hidden=\"true\" tabindex=\"-1\"></a>                  for2 <span class=\"ot\">=</span> <span class=\"fu\">map</span> (<span class=\"fu\">zipWith</span> (<span class=\"op\">-</span>) x) for1</span>\n<span id=\"cb1-36\"><a href=\"#cb1-36\" aria-hidden=\"true\" tabindex=\"-1\"></a>                  coef1 <span class=\"ot\">=</span> <span class=\"fu\">map</span> f1 for1</span>\n<span id=\"cb1-37\"><a href=\"#cb1-37\" aria-hidden=\"true\" tabindex=\"-1\"></a>                  coef2 <span class=\"ot\">=</span> <span class=\"fu\">map</span> f2 for2</span>\n<span id=\"cb1-38\"><a href=\"#cb1-38\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-39\"><a href=\"#cb1-39\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">data</span> <span class=\"dt\">PairF</span> e <span class=\"ot\">=</span> <span class=\"dt\">Pair</span> (<span class=\"dt\">Maybe</span> (<span class=\"dt\">Int</span>, e))</span>\n<span id=\"cb1-40\"><a href=\"#cb1-40\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">type</span> <span class=\"dt\">Pair</span> <span class=\"ot\">=</span> <span class=\"dt\">Fix</span> <span class=\"dt\">PairF</span></span>\n<span id=\"cb1-41\"><a href=\"#cb1-41\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-42\"><a href=\"#cb1-42\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">instance</span> <span class=\"dt\">Functor</span> <span class=\"dt\">PairF</span> <span class=\"kw\">where</span></span>\n<span id=\"cb1-43\"><a href=\"#cb1-43\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">fmap</span> f (<span class=\"dt\">Pair</span> e) <span class=\"ot\">=</span> <span class=\"dt\">Pair</span> <span class=\"op\">$</span> <span class=\"fu\">fmap</span> (second f) e</span>\n<span id=\"cb1-44\"><a href=\"#cb1-44\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-45\"><a href=\"#cb1-45\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">cartesian ::</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Pair</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Pair</span>]</span>\n<span id=\"cb1-46\"><a href=\"#cb1-46\" aria-hidden=\"true\" tabindex=\"-1\"></a>cartesian xs ys <span class=\"ot\">=</span> [<span class=\"dt\">Fix</span> <span class=\"op\">$</span> <span class=\"dt\">Pair</span> <span class=\"op\">$</span> <span class=\"dt\">Just</span> (x, y) <span class=\"op\">|</span> x <span class=\"ot\">&lt;-</span> xs, y <span class=\"ot\">&lt;-</span> ys]</span>\n<span id=\"cb1-47\"><a href=\"#cb1-47\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-48\"><a href=\"#cb1-48\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">pairAlg ::</span> <span class=\"dt\">PairF</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-49\"><a href=\"#cb1-49\" aria-hidden=\"true\" tabindex=\"-1\"></a>pairAlg (<span class=\"dt\">Pair</span> m) <span class=\"ot\">=</span> <span class=\"kw\">case</span> m <span class=\"kw\">of</span></span>\n<span id=\"cb1-50\"><a href=\"#cb1-50\" aria-hidden=\"true\" tabindex=\"-1\"></a>                        <span class=\"dt\">Nothing</span> <span class=\"ot\">-&gt;</span> []</span>\n<span id=\"cb1-51\"><a href=\"#cb1-51\" aria-hidden=\"true\" tabindex=\"-1\"></a>                        <span class=\"dt\">Just</span> (x, xs) <span class=\"ot\">-&gt;</span> x<span class=\"op\">:</span>xs</span>\n<span id=\"cb1-52\"><a href=\"#cb1-52\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-53\"><a href=\"#cb1-53\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">bb ::</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [[<span class=\"dt\">Int</span>]]</span>\n<span id=\"cb1-54\"><a href=\"#cb1-54\" aria-hidden=\"true\" tabindex=\"-1\"></a>bb xs <span class=\"ot\">=</span> <span class=\"fu\">map</span> (cata pairAlg) <span class=\"op\">$</span> <span class=\"fu\">foldr</span> cartesian [<span class=\"dt\">Fix</span> <span class=\"op\">$</span> <span class=\"dt\">Pair</span> <span class=\"dt\">Nothing</span>] <span class=\"op\">$</span> <span class=\"fu\">map</span> (\\x <span class=\"ot\">-&gt;</span> [<span class=\"dv\">0</span><span class=\"op\">..</span>x]) xs</span></code></pre></div>\n<h2 id=\"test\">Test</h2>\n<div class=\"sourceCode\" id=\"cb2\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">Main</span> <span class=\"kw\">where</span></span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb2-3\"><a href=\"#cb2-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb2-4\"><a href=\"#cb2-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"kw\">qualified</span> <span class=\"dt\">NPoly</span></span>\n<span id=\"cb2-5\"><a href=\"#cb2-5\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb2-6\"><a href=\"#cb2-6\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb2-7\"><a href=\"#cb2-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">main ::</span> <span class=\"dt\">IO</span> ()</span>\n<span id=\"cb2-8\"><a href=\"#cb2-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>main <span class=\"ot\">=</span> <span class=\"kw\">do</span></span>\n<span id=\"cb2-9\"><a href=\"#cb2-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> added <span class=\"ot\">=</span> cata NPoly.alg <span class=\"op\">$</span> <span class=\"dt\">Fix</span> (<span class=\"dt\">RAdd</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>) (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>))</span>\n<span id=\"cb2-10\"><a href=\"#cb2-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> multiplied <span class=\"ot\">=</span> cata NPoly.alg <span class=\"op\">$</span> <span class=\"dt\">Fix</span> (<span class=\"dt\">RMul</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>) (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>))</span>\n<span id=\"cb2-11\"><a href=\"#cb2-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> multiplied2 <span class=\"ot\">=</span> cata NPoly.alg <span class=\"op\">$</span> <span class=\"dt\">Fix</span> (<span class=\"dt\">RMul</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>) (<span class=\"dt\">Fix</span> <span class=\"dt\">RZero</span>))</span>\n<span id=\"cb2-12\"><a href=\"#cb2-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">let</span> negated <span class=\"ot\">=</span> cata NPoly.alg <span class=\"op\">$</span> <span class=\"dt\">Fix</span> (<span class=\"dt\">RMul</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>) (<span class=\"dt\">Fix</span> (<span class=\"dt\">RNeg</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>))))</span>\n<span id=\"cb2-13\"><a href=\"#cb2-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> square added</span>\n<span id=\"cb2-14\"><a href=\"#cb2-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> square multiplied</span>\n<span id=\"cb2-15\"><a href=\"#cb2-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> square multiplied2</span>\n<span id=\"cb2-16\"><a href=\"#cb2-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> square negated</span>\n<span id=\"cb2-17\"><a href=\"#cb2-17\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb2-18\"><a href=\"#cb2-18\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">square ::</span> <span class=\"dt\">NPoly.NPoly</span> <span class=\"ot\">-&gt;</span> [[<span class=\"dt\">Int</span>]]</span>\n<span id=\"cb2-19\"><a href=\"#cb2-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>square poly <span class=\"ot\">=</span> <span class=\"fu\">map</span> f [<span class=\"dv\">0</span><span class=\"op\">..</span><span class=\"dv\">3</span>]</span>\n<span id=\"cb2-20\"><a href=\"#cb2-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">where</span><span class=\"ot\"> f ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb2-21\"><a href=\"#cb2-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>          f x <span class=\"ot\">=</span> <span class=\"fu\">map</span> (g x) [<span class=\"dv\">0</span><span class=\"op\">..</span><span class=\"dv\">3</span>]</span>\n<span id=\"cb2-22\"><a href=\"#cb2-22\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"kw\">where</span><span class=\"ot\"> g ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span></span>\n<span id=\"cb2-23\"><a href=\"#cb2-23\" aria-hidden=\"true\" tabindex=\"-1\"></a>                  g x y <span class=\"ot\">=</span> poly [x,y]</span></code></pre></div>\n<h2 id=\"result\">Result</h2>\n<pre class=\"shell\"><code>ingun$ stack run\n[[2,0,0],\n [0,0,0],\n [0,0,0]]\n\n[[1,0,0],\n [0,0,0],\n [0,0,0]]\n\n[[0,0,0],\n [0,0,0],\n [0,0,0]]\n\n[[-1,0,0],\n [0,0,0],\n [0,0,0]]</code></pre>\n<p>First one is identity + identity Second one is identity * identity\nThird one is identity * zero Fourth one is identity * -identity</p>",
                "q": "<p>Generalize the previous construction to polynomials of many\nindependent variables, like <span\nclass=\"math inline\">x^2y-3y^3z</span>.</p>"
            },
            "numAnswer": 1,
            "sha1": "72dfaf0c8ae30bd66581ac3810493a3f1d48d6cf",
            "title": "2"
        },
        {
            "attr": {
                "a": "<div class=\"sourceCode\" id=\"cb1\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">Rib</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ( coalg, toListC</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ) <span class=\"kw\">where</span></span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Matrix</span></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">data</span> <span class=\"dt\">StreamF</span> a <span class=\"ot\">=</span> <span class=\"dt\">StreamF</span> <span class=\"dt\">Int</span> a</span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">instance</span> <span class=\"dt\">Functor</span> <span class=\"dt\">StreamF</span> <span class=\"kw\">where</span></span>\n<span id=\"cb1-10\"><a href=\"#cb1-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">fmap</span> f (<span class=\"dt\">StreamF</span> n x) <span class=\"ot\">=</span> <span class=\"dt\">StreamF</span> n (f x)</span>\n<span id=\"cb1-11\"><a href=\"#cb1-11\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-12\"><a href=\"#cb1-12\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">type</span> <span class=\"dt\">Stream</span> <span class=\"ot\">=</span> <span class=\"dt\">Fix</span> <span class=\"dt\">StreamF</span></span>\n<span id=\"cb1-13\"><a href=\"#cb1-13\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-14\"><a href=\"#cb1-14\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">coalg ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">StreamF</span> <span class=\"dt\">Int</span></span>\n<span id=\"cb1-15\"><a href=\"#cb1-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>coalg n <span class=\"ot\">=</span> <span class=\"dt\">StreamF</span> (n<span class=\"op\">*</span>n) (n<span class=\"op\">+</span><span class=\"dv\">1</span>)</span>\n<span id=\"cb1-16\"><a href=\"#cb1-16\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-17\"><a href=\"#cb1-17\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">toListC ::</span> <span class=\"dt\">Fix</span> <span class=\"dt\">StreamF</span> <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-18\"><a href=\"#cb1-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>toListC <span class=\"ot\">=</span> cata al <span class=\"kw\">where</span><span class=\"ot\"> al ::</span> <span class=\"dt\">StreamF</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-19\"><a href=\"#cb1-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>                        al (<span class=\"dt\">StreamF</span> n arr) <span class=\"ot\">=</span> n <span class=\"op\">:</span> arr</span></code></pre></div>\n<h2 id=\"test\">Test</h2>\n<div class=\"sourceCode\" id=\"cb2\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Rib</span></span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb2-3\"><a href=\"#cb2-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb2-4\"><a href=\"#cb2-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">main ::</span> <span class=\"dt\">IO</span> ()</span>\n<span id=\"cb2-5\"><a href=\"#cb2-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>main <span class=\"ot\">=</span> <span class=\"kw\">do</span></span>\n<span id=\"cb2-6\"><a href=\"#cb2-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> <span class=\"fu\">take</span> <span class=\"dv\">5</span> <span class=\"op\">$</span> toListC <span class=\"op\">$</span> ana coalg <span class=\"dv\">1</span></span></code></pre></div>\n<h2 id=\"result\">Result</h2>\n<pre class=\"shell\"><code>ingun$ stack test\n...\n[1,4,9,16,25]</code></pre>",
                "q": "<p>Define a coalgebra whose anamorphism produces a list of squares of\nnatural numbers.</p>"
            },
            "numAnswer": 1,
            "sha1": "0988f4e1bbfb98a035758d2eff40c5d568a914c3",
            "title": "4"
        },
        {
            "attr": {
                "a": "<p>I choosed <code>Rational</code> as type of element of Matrix because\nmatrix is over field and rational numbers is field.</p>\n<div class=\"sourceCode\" id=\"cb1\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">Lib</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ( alg, <span class=\"dt\">RingF</span>(<span class=\"op\">..</span>), matalg</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ) <span class=\"kw\">where</span></span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Matrix</span></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">data</span> <span class=\"dt\">RingF</span> a <span class=\"ot\">=</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RAdd</span> a a </span>\n<span id=\"cb1-10\"><a href=\"#cb1-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RMul</span> a a</span>\n<span id=\"cb1-11\"><a href=\"#cb1-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RNeg</span> a</span>\n<span id=\"cb1-12\"><a href=\"#cb1-12\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-13\"><a href=\"#cb1-13\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">instance</span> <span class=\"dt\">Functor</span> <span class=\"dt\">RingF</span> <span class=\"kw\">where</span></span>\n<span id=\"cb1-14\"><a href=\"#cb1-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">fmap</span> f r <span class=\"ot\">=</span> <span class=\"kw\">case</span> r <span class=\"kw\">of</span></span>\n<span id=\"cb1-15\"><a href=\"#cb1-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RZero</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-16\"><a href=\"#cb1-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">ROne</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-17\"><a href=\"#cb1-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RAdd</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RAdd</span> (f a) (f b)</span>\n<span id=\"cb1-18\"><a href=\"#cb1-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RMul</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RMul</span> (f a) (f b)</span>\n<span id=\"cb1-19\"><a href=\"#cb1-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RNeg</span> a <span class=\"ot\">-&gt;</span> <span class=\"dt\">RNeg</span> (f a)</span>\n<span id=\"cb1-20\"><a href=\"#cb1-20\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-21\"><a href=\"#cb1-21\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">type</span> <span class=\"dt\">Ring</span> <span class=\"ot\">=</span> <span class=\"dt\">Fix</span> <span class=\"dt\">RingF</span></span>\n<span id=\"cb1-22\"><a href=\"#cb1-22\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-23\"><a href=\"#cb1-23\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">type</span> <span class=\"dt\">Mat</span> <span class=\"ot\">=</span> <span class=\"dt\">Matrix</span> <span class=\"dt\">Rational</span></span>\n<span id=\"cb1-24\"><a href=\"#cb1-24\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">matalg ::</span> <span class=\"dt\">RingF</span> <span class=\"dt\">Mat</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">Mat</span></span>\n<span id=\"cb1-25\"><a href=\"#cb1-25\" aria-hidden=\"true\" tabindex=\"-1\"></a>matalg <span class=\"dt\">RZero</span> <span class=\"ot\">=</span> zero <span class=\"dv\">2</span> <span class=\"dv\">2</span> </span>\n<span id=\"cb1-26\"><a href=\"#cb1-26\" aria-hidden=\"true\" tabindex=\"-1\"></a>matalg <span class=\"dt\">ROne</span> <span class=\"ot\">=</span> identity <span class=\"dv\">2</span> </span>\n<span id=\"cb1-27\"><a href=\"#cb1-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>matalg (<span class=\"dt\">RNeg</span> x) <span class=\"ot\">=</span> <span class=\"fu\">fmap</span> <span class=\"fu\">negate</span> x </span>\n<span id=\"cb1-28\"><a href=\"#cb1-28\" aria-hidden=\"true\" tabindex=\"-1\"></a>matalg (<span class=\"dt\">RAdd</span> x y) <span class=\"ot\">=</span> elementwise (<span class=\"op\">+</span>) x y </span>\n<span id=\"cb1-29\"><a href=\"#cb1-29\" aria-hidden=\"true\" tabindex=\"-1\"></a>matalg (<span class=\"dt\">RMul</span> x y) <span class=\"ot\">=</span> multStd x y </span></code></pre></div>\n<h2 id=\"test\">Test</h2>\n<div class=\"sourceCode\" id=\"cb2\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">main ::</span> <span class=\"dt\">IO</span> ()</span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>main <span class=\"ot\">=</span> <span class=\"kw\">do</span></span>\n<span id=\"cb2-3\"><a href=\"#cb2-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> cata matalg <span class=\"op\">$</span> <span class=\"dt\">Fix</span> (<span class=\"dt\">RAdd</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>) (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>))</span></code></pre></div>\n<h2 id=\"result\">Result</h2>\n<pre class=\"shell\"><code>ingun$ stack test\n...\n 2 % 1 0 % 1\n 0 % 1 2 % 1</code></pre>",
                "q": "<p>Implement the algebra for the ring of 2x2 matrices.</p>"
            },
            "numAnswer": 1,
            "sha1": "b85ceba01c6cb465c293e631380d19ea81368a21",
            "title": "3"
        },
        {
            "attr": {
                "a": "<div class=\"sourceCode\" id=\"cb1\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">module</span> <span class=\"dt\">Lib</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ( alg, <span class=\"dt\">RingF</span>(<span class=\"op\">..</span>), calc</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ) <span class=\"kw\">where</span></span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">data</span> <span class=\"dt\">RingF</span> a <span class=\"ot\">=</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RAdd</span> a a </span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RMul</span> a a</span>\n<span id=\"cb1-10\"><a href=\"#cb1-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>             <span class=\"op\">|</span> <span class=\"dt\">RNeg</span> a</span>\n<span id=\"cb1-11\"><a href=\"#cb1-11\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-12\"><a href=\"#cb1-12\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">instance</span> <span class=\"dt\">Functor</span> <span class=\"dt\">RingF</span> <span class=\"kw\">where</span></span>\n<span id=\"cb1-13\"><a href=\"#cb1-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">fmap</span> f r <span class=\"ot\">=</span> <span class=\"kw\">case</span> r <span class=\"kw\">of</span></span>\n<span id=\"cb1-14\"><a href=\"#cb1-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RZero</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">RZero</span></span>\n<span id=\"cb1-15\"><a href=\"#cb1-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">ROne</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">ROne</span></span>\n<span id=\"cb1-16\"><a href=\"#cb1-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RAdd</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RAdd</span> (f a) (f b)</span>\n<span id=\"cb1-17\"><a href=\"#cb1-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RMul</span> a b <span class=\"ot\">-&gt;</span> <span class=\"dt\">RMul</span> (f a) (f b)</span>\n<span id=\"cb1-18\"><a href=\"#cb1-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"dt\">RNeg</span> a <span class=\"ot\">-&gt;</span> <span class=\"dt\">RNeg</span> (f a)</span>\n<span id=\"cb1-19\"><a href=\"#cb1-19\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-20\"><a href=\"#cb1-20\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">type</span> <span class=\"dt\">Ring</span> <span class=\"ot\">=</span> <span class=\"dt\">Fix</span> <span class=\"dt\">RingF</span></span>\n<span id=\"cb1-21\"><a href=\"#cb1-21\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-22\"><a href=\"#cb1-22\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">take&#39; ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-23\"><a href=\"#cb1-23\" aria-hidden=\"true\" tabindex=\"-1\"></a>take&#39; n l <span class=\"ot\">=</span> <span class=\"kw\">if</span> n <span class=\"op\">&gt;</span> <span class=\"dv\">0</span> <span class=\"kw\">then</span> <span class=\"kw\">case</span> l <span class=\"kw\">of</span> [] <span class=\"ot\">-&gt;</span> <span class=\"fu\">replicate</span> n <span class=\"dv\">0</span></span>\n<span id=\"cb1-24\"><a href=\"#cb1-24\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                    (x<span class=\"op\">:</span>xs) <span class=\"ot\">-&gt;</span> x<span class=\"op\">:</span>(take&#39; (n<span class=\"op\">-</span><span class=\"dv\">1</span>) xs)</span>\n<span id=\"cb1-25\"><a href=\"#cb1-25\" aria-hidden=\"true\" tabindex=\"-1\"></a>                     <span class=\"kw\">else</span> []</span>\n<span id=\"cb1-26\"><a href=\"#cb1-26\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">degree ::</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span></span>\n<span id=\"cb1-27\"><a href=\"#cb1-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>degree xs <span class=\"ot\">=</span> <span class=\"fu\">max</span> <span class=\"dv\">0</span> <span class=\"op\">$</span> <span class=\"fu\">length</span> xs <span class=\"op\">-</span> <span class=\"dv\">1</span></span>\n<span id=\"cb1-28\"><a href=\"#cb1-28\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-29\"><a href=\"#cb1-29\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">alg ::</span> <span class=\"dt\">RingF</span> [<span class=\"dt\">Int</span>] <span class=\"ot\">-&gt;</span> [<span class=\"dt\">Int</span>]</span>\n<span id=\"cb1-30\"><a href=\"#cb1-30\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg <span class=\"dt\">RZero</span> <span class=\"ot\">=</span> []</span>\n<span id=\"cb1-31\"><a href=\"#cb1-31\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg <span class=\"dt\">ROne</span> <span class=\"ot\">=</span> [<span class=\"dv\">1</span>]</span>\n<span id=\"cb1-32\"><a href=\"#cb1-32\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RNeg</span> x) <span class=\"ot\">=</span> <span class=\"fu\">map</span> <span class=\"fu\">negate</span> x</span>\n<span id=\"cb1-33\"><a href=\"#cb1-33\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RAdd</span> (x<span class=\"op\">:</span>xs) (y<span class=\"op\">:</span>ys)) <span class=\"ot\">=</span> (x<span class=\"op\">+</span>y)<span class=\"op\">:</span>(alg <span class=\"op\">$</span> <span class=\"dt\">RAdd</span> xs ys)</span>\n<span id=\"cb1-34\"><a href=\"#cb1-34\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RAdd</span> [] y) <span class=\"ot\">=</span> y</span>\n<span id=\"cb1-35\"><a href=\"#cb1-35\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RAdd</span> x []) <span class=\"ot\">=</span> x</span>\n<span id=\"cb1-36\"><a href=\"#cb1-36\" aria-hidden=\"true\" tabindex=\"-1\"></a>alg (<span class=\"dt\">RMul</span> x y) <span class=\"ot\">=</span> <span class=\"kw\">let</span><span class=\"ot\"> f ::</span> <span class=\"dt\">Int</span> <span class=\"ot\">-&gt;</span> <span class=\"dt\">Int</span></span>\n<span id=\"cb1-37\"><a href=\"#cb1-37\" aria-hidden=\"true\" tabindex=\"-1\"></a>                     f n <span class=\"ot\">=</span> <span class=\"kw\">let</span> xs <span class=\"ot\">=</span> take&#39; (n<span class=\"op\">+</span><span class=\"dv\">1</span>) x</span>\n<span id=\"cb1-38\"><a href=\"#cb1-38\" aria-hidden=\"true\" tabindex=\"-1\"></a>                               ys <span class=\"ot\">=</span> <span class=\"fu\">reverse</span> <span class=\"op\">$</span> take&#39; (n<span class=\"op\">+</span><span class=\"dv\">1</span>) y <span class=\"kw\">in</span></span>\n<span id=\"cb1-39\"><a href=\"#cb1-39\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                   <span class=\"fu\">sum</span> <span class=\"op\">$</span> <span class=\"fu\">zipWith</span> (<span class=\"op\">*</span>) xs ys</span>\n<span id=\"cb1-40\"><a href=\"#cb1-40\" aria-hidden=\"true\" tabindex=\"-1\"></a>                     <span class=\"kw\">in</span></span>\n<span id=\"cb1-41\"><a href=\"#cb1-41\" aria-hidden=\"true\" tabindex=\"-1\"></a>                         <span class=\"fu\">map</span> f [<span class=\"dv\">0</span><span class=\"op\">..</span>(degree x <span class=\"op\">+</span> degree y)]</span></code></pre></div>\n<h2 id=\"test\">Test</h2>\n<div class=\"sourceCode\" id=\"cb2\"><pre\nclass=\"sourceCode haskell\"><code class=\"sourceCode haskell\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Lib</span></span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">import</span> <span class=\"dt\">Data.Fix</span></span>\n<span id=\"cb2-3\"><a href=\"#cb2-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb2-4\"><a href=\"#cb2-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ot\">main ::</span> <span class=\"dt\">IO</span> ()</span>\n<span id=\"cb2-5\"><a href=\"#cb2-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>main <span class=\"ot\">=</span> <span class=\"kw\">do</span></span>\n<span id=\"cb2-6\"><a href=\"#cb2-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"fu\">print</span> <span class=\"op\">$</span> cata alg <span class=\"op\">$</span> <span class=\"dt\">Fix</span> (<span class=\"dt\">RAdd</span> (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>) (<span class=\"dt\">Fix</span> <span class=\"dt\">ROne</span>))</span></code></pre></div>\n<h2 id=\"result\">Result</h2>\n<pre class=\"shell\"><code>ingun$ stack test\n...\n[2]</code></pre>",
                "q": "<p>Implement the evaluation function for a ring of polynomials of one\nvariable. You can represent a polynomial as a list of coefficients in\nfront of powers of <code>x</code>. For instance, <span\nclass=\"math inline\">4x^2-1</span> would be represented as (starting with\nthe zero'th power) <code>[-1, 0, 4]</code>.</p>"
            },
            "numAnswer": 1,
            "sha1": "b12b2bea8989448243e1ab04369f436e4816bd81",
            "title": "1"
        }
    ],
    "parentSha1": "bd467f809ce2a42bd342fce03ff7fd2bd3d8446c",
    "path": "answers-db/books/Category Theory For Programmers/24. F-Algebras"
}