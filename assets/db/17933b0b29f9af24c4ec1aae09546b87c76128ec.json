{"parentSha1":"d06c4c6b4f04536f9e5a620afbe8cc53b23c2fc6","path":"books/Introduction to Probability, Statistics, and Random Processes/2.2.0/13/a","kids":[],"item":{"attr":{"a":"Let $`A`$ be the event of choosing the first coin, $`B`$ the second coin, $`H_i`$ the observing $`i`$ heads. They are partitions therefore\n\n```math\nP(H_3 \\cup H_4 \\cup H_5) = P(H_3 \\cup H_4 \\cup H_5|A)P(A) + P(H_3 \\cup H_4 \\cup H_5|B)P(B)\n```\n\nSince $`H_i`$ are all disjoint events\n\n```math\n= (P(H_3|A) + P(H_4|A) + P(H_5|A))P(A) + (P(H_3|B) + P(H_4|B) + P(H_5|B))P(B)\n```\n\n$`P(H_3|A)`$ is having three heads and two tails using the first coin.\n\n```math\nP(H_3|A) = {5 \\choose 3} \\left({1 \\over 2}\\right)^3 \\left({1 \\over 2}\\right)^2 = {5 \\choose 3}{1 \\over 2^5}\n```\n\nWe can calculate each terms in the same way.\n\n```math\n= ({5 \\choose 3}{1 \\over 2^5} \n+ {5 \\choose 4}{1 \\over 2^5}  \n+ {5 \\choose 5}{1 \\over 2^5}  )P(A) + \n({5 \\choose 3}{2^2 \\over 3^5 }\n+ {5 \\choose 4}{ 2 \\over 3^5}\n+ {5 \\choose 5}{1 \\over 3^5}\n)P(B)\n```\n\nSince $`P(A) = P(B) = {1 \\over 2}`$\n\n```math\n= (10 + 5 + 1){1 \\over 2^6} + \n(40\n+ 10\n+ 1\n){1 \\over 3^5 2} \\\\\n\n\\approx 0.3549\n```\n\nHere's a validating program.\n\n```haskell\nmodule Lib\n    ( someFunc\n    ) where\nimport System.Random\nimport System.Random.Shuffle\nimport Data.Ix\nimport Data.Ratio\nimport Data.Set hiding (map, take, filter)\nimport Data.List.Split\n\nsomeFunc :: IO ()\nsomeFunc = do\n    problem13\n\nproblem13 :: IO ()\nproblem13 = do\n    let seeds = [1..]\n    let sampleSize = 1000000\n    let samples = take sampleSize $ map pickAndFlip5 seeds\n    let events = filter ((2<) . length . filter id) samples\n    let eventSize = length events\n    print $ approxRatio eventSize sampleSize\n\nflipCoinN :: RandomGen g => Double -> Int -> g -> [Bool]\nflipCoinN p n = map (p>) . take n . randomRs (0.0, 1.0)\n\npickAndFlip5 :: Int -> [Bool]\npickAndFlip5 seed = let (which, g) = (random $ mkStdGen seed)\n                   in if which\n                       then flipCoinN 0.5 5 g\n                       else flipCoinN 0.3333333333 5 g\n\napproxRatio :: Integral i => i -> i -> Double\napproxRatio x y = fromRational $ (toInteger x) % (toInteger y)\n\n```\n\nOutput is\n\n```shell\n0.356264\n```\n\nwhich is close enough to support the result.","q":"What is the probability of observing at least 3 heads?"},"sha1":"17933b0b29f9af24c4ec1aae09546b87c76128ec","title":"a"}}