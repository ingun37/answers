{"parentSha1":"af0919b42ae94cf4639db15c51edc99ce986c6f4","path":"books/Neural Networks and Deep Learning/2. How the backpropagation algorithm works","item":{"title":"2. How the backpropagation algorithm works","attr":{},"sha1":"4484af5b46b7994aa3e9ad9149ac8895383b7639"},"kids":[{"title":"Proof of the four fundamental equations (optional)","attr":{"q":"Prove Equations (BP3) and (BP4).","a":"### BP3\n\nBP3 is\n\n```math\n\\frac{\\partial C}{\\partial b^l_j} = \\delta^l_j\n```\n\nBy chain rule\n\n```math\n\\frac{\\partial C}{\\partial b^l_j} = \\frac{\\partial z_j}{\\partial b^l_j} \\frac{\\partial C}{\\partial z_j}\n```\n\nDefinition of $`z_j`$ is\n\n```math\nz_j = b_j + w_j a\n```\n\nwhere $`w_j`$ is weight matix's jth row. We can easily see that\n\n```math\n\\frac{\\partial z_j}{\\partial b^l_j} = 1 \\\\\n\\rightarrow \\frac{\\partial C}{\\partial b^l_j} = \\frac{\\partial C}{\\partial z_j} = \\delta^l_j\n```\n\n### BP4\n\nBP4 is\n\n```math\n\\frac{\\partial C}{\\partial w^l_{jk}} = a^{l-1}_k \\delta^l_j\n```\n\nBy chain rule\n\n```math\n\\frac{\\partial C}{\\partial ^l_j} = \\frac{\\partial z_j}{\\partial w^jk} \\frac{\\partial C}{\\partial z_j}\n```\n\nDefinition of $`z_j'$ is\n\n```math\n\\begin{aligned}\nz_j &= b_j + w_j \\cdot a \\\\\n    &= b_j + \\sum w_{jk} a_k\n\\end{aligned}\n```\n\nDerivative of $`z_j`$ in terms of $`w_{jk}`$ is easily\n\n```math\n\\begin{aligned}\n&\\frac{\\partial z_j}{\\partial w^jk} = a_k \\\\\n&\\rightarrow \\frac{\\partial z_j}{\\partial w^jk} \\frac{\\partial C}{\\partial z_j} \\\\\n&= a_k \\delta^l_j\n\\end{aligned}\n```"},"sha1":"7d745fe1c056f7fb8a01adfbaba1824f3f9e2f4d"},{"title":"The four fundamental equations behind backpropagation","attr":{},"sha1":"4807c04a2a44d49ad22ff425c5b889cdd6d5dff2"}]}